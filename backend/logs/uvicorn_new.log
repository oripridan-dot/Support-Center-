/workspaces/Support-Center-/backend/app/services/rag_service.py:5: FutureWarning: 

All support for the `google.generativeai` package has ended. It will no longer be receiving 
updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
See README for more details:

https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md

  import google.generativeai as genai
INFO:     Started server process [389829]
INFO:     Waiting for application startup.
2025-12-22 13:40:15,029 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:40:15,029 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("brand")
2025-12-22 13:40:15,030 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-22 13:40:15,030 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("productfamily")
2025-12-22 13:40:15,031 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-22 13:40:15,033 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("product")
2025-12-22 13:40:15,033 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-22 13:40:15,033 INFO sqlalchemy.engine.Engine PRAGMA main.table_info("document")
2025-12-22 13:40:15,033 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-12-22 13:40:15,034 INFO sqlalchemy.engine.Engine COMMIT
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
CRITICAL: ChromaDB query failed: Error executing plan: Internal error: Error finding id
INFO:     127.0.0.1:58710 - "POST /api/chat HTTP/1.1" 200 OK
CRITICAL: ChromaDB query failed: Error executing plan: Internal error: Error finding id
INFO:     127.0.0.1:41568 - "POST /api/chat HTTP/1.1" 200 OK
2025-12-22 13:44:56,563 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:44:56,569 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:44:56,593 INFO sqlalchemy.engine.Engine SELECT product.id, product.name, product.description, product.image_url, product.family_id 
FROM product JOIN productfamily ON productfamily.id = product.family_id 
WHERE productfamily.brand_id = ?
2025-12-22 13:44:56,599 INFO sqlalchemy.engine.Engine [generated in 0.00609s] (28,)
2025-12-22 13:44:56,597 INFO sqlalchemy.engine.Engine SELECT brand.id AS brand_id, brand.name AS brand_name, brand.logo_url AS brand_logo_url, brand.website_url AS brand_website_url, brand.description AS brand_description, brand.primary_color AS brand_primary_color, brand.secondary_color AS brand_secondary_color 
FROM brand 
WHERE brand.id = ?
2025-12-22 13:44:56,599 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:44:56,600 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:44:56,601 INFO sqlalchemy.engine.Engine [generated in 0.00016s] (100, 0)
2025-12-22 13:44:56,599 INFO sqlalchemy.engine.Engine [generated in 0.00296s] (28,)
INFO:     5.28.168.163:0 - "GET /api/brands/28/products HTTP/1.1" 200 OK
2025-12-22 13:44:56,618 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     5.28.168.163:0 - "GET /api/brands/28 HTTP/1.1" 200 OK
2025-12-22 13:44:56,628 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:44:56,630 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:45:55,374 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:45:55,374 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:45:55,375 INFO sqlalchemy.engine.Engine [cached since 58.77s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:45:55,378 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:45:55,505 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:45:55,505 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:45:55,505 INFO sqlalchemy.engine.Engine [cached since 58.9s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:45:55,509 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:45:55,606 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:45:55,606 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:45:55,607 INFO sqlalchemy.engine.Engine [cached since 59.01s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:45:55,609 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:45:55,715 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:45:55,715 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:45:55,716 INFO sqlalchemy.engine.Engine [cached since 59.12s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:45:55,718 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:00,298 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:00,302 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:46:00,302 INFO sqlalchemy.engine.Engine [cached since 63.7s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:46:00,311 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:00,326 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:00,327 INFO sqlalchemy.engine.Engine SELECT brand.id AS brand_id, brand.name AS brand_name, brand.logo_url AS brand_logo_url, brand.website_url AS brand_website_url, brand.description AS brand_description, brand.primary_color AS brand_primary_color, brand.secondary_color AS brand_secondary_color 
FROM brand 
WHERE brand.id = ?
2025-12-22 13:46:00,327 INFO sqlalchemy.engine.Engine [cached since 63.73s ago] (3,)
INFO:     5.28.168.163:0 - "GET /api/brands/3 HTTP/1.1" 200 OK
2025-12-22 13:46:00,327 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:00,331 INFO sqlalchemy.engine.Engine SELECT product.id, product.name, product.description, product.image_url, product.family_id 
FROM product JOIN productfamily ON productfamily.id = product.family_id 
WHERE productfamily.brand_id = ?
2025-12-22 13:46:00,331 INFO sqlalchemy.engine.Engine [cached since 63.74s ago] (3,)
2025-12-22 13:46:00,331 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     5.28.168.163:0 - "GET /api/brands/3/products HTTP/1.1" 200 OK
2025-12-22 13:46:00,335 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:00,434 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:00,435 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:46:00,435 INFO sqlalchemy.engine.Engine [cached since 63.83s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:46:00,441 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:00,457 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:00,458 INFO sqlalchemy.engine.Engine SELECT brand.id AS brand_id, brand.name AS brand_name, brand.logo_url AS brand_logo_url, brand.website_url AS brand_website_url, brand.description AS brand_description, brand.primary_color AS brand_primary_color, brand.secondary_color AS brand_secondary_color 
FROM brand 
WHERE brand.id = ?
2025-12-22 13:46:00,458 INFO sqlalchemy.engine.Engine [cached since 63.86s ago] (3,)
INFO:     5.28.168.163:0 - "GET /api/brands/3 HTTP/1.1" 200 OK
2025-12-22 13:46:00,460 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:00,484 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:00,486 INFO sqlalchemy.engine.Engine SELECT product.id, product.name, product.description, product.image_url, product.family_id 
FROM product JOIN productfamily ON productfamily.id = product.family_id 
WHERE productfamily.brand_id = ?
2025-12-22 13:46:00,486 INFO sqlalchemy.engine.Engine [cached since 63.89s ago] (3,)
INFO:     5.28.168.163:0 - "GET /api/brands/3/products HTTP/1.1" 200 OK
2025-12-22 13:46:00,489 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:08,476 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:08,476 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:46:08,476 INFO sqlalchemy.engine.Engine [cached since 71.88s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:46:08,480 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:09,148 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:09,149 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:46:09,149 INFO sqlalchemy.engine.Engine [cached since 72.55s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:46:09,152 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:09,598 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:09,599 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:46:09,599 INFO sqlalchemy.engine.Engine [cached since 73s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:46:09,601 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:10,071 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:10,072 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:46:10,072 INFO sqlalchemy.engine.Engine [cached since 73.47s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:46:10,074 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:37,782 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:37,783 INFO sqlalchemy.engine.Engine SELECT product.id, product.name, product.description, product.image_url, product.family_id 
FROM product JOIN productfamily ON productfamily.id = product.family_id 
WHERE productfamily.brand_id = ?
2025-12-22 13:46:37,783 INFO sqlalchemy.engine.Engine [cached since 101.2s ago] (88,)
2025-12-22 13:46:37,784 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:37,785 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:46:37,785 INFO sqlalchemy.engine.Engine [cached since 101.2s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:46:37,788 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:37,788 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:37,789 INFO sqlalchemy.engine.Engine SELECT brand.id AS brand_id, brand.name AS brand_name, brand.logo_url AS brand_logo_url, brand.website_url AS brand_website_url, brand.description AS brand_description, brand.primary_color AS brand_primary_color, brand.secondary_color AS brand_secondary_color 
FROM brand 
WHERE brand.id = ?
2025-12-22 13:46:37,789 INFO sqlalchemy.engine.Engine [cached since 101.2s ago] (88,)
INFO:     5.28.168.163:0 - "GET /api/brands/88 HTTP/1.1" 200 OK
2025-12-22 13:46:37,794 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     5.28.168.163:0 - "GET /api/brands/88/products HTTP/1.1" 200 OK
2025-12-22 13:46:37,851 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:38,257 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:38,258 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:46:38,258 INFO sqlalchemy.engine.Engine [cached since 101.7s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:46:38,260 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:38,273 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:38,273 INFO sqlalchemy.engine.Engine SELECT brand.id AS brand_id, brand.name AS brand_name, brand.logo_url AS brand_logo_url, brand.website_url AS brand_website_url, brand.description AS brand_description, brand.primary_color AS brand_primary_color, brand.secondary_color AS brand_secondary_color 
FROM brand 
WHERE brand.id = ?
2025-12-22 13:46:38,273 INFO sqlalchemy.engine.Engine [cached since 101.7s ago] (88,)
INFO:     5.28.168.163:0 - "GET /api/brands/88 HTTP/1.1" 200 OK
2025-12-22 13:46:38,276 INFO sqlalchemy.engine.Engine ROLLBACK
2025-12-22 13:46:38,398 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:46:38,398 INFO sqlalchemy.engine.Engine SELECT product.id, product.name, product.description, product.image_url, product.family_id 
FROM product JOIN productfamily ON productfamily.id = product.family_id 
WHERE productfamily.brand_id = ?
2025-12-22 13:46:38,398 INFO sqlalchemy.engine.Engine [cached since 101.8s ago] (88,)
INFO:     5.28.168.163:0 - "GET /api/brands/88/products HTTP/1.1" 200 OK
2025-12-22 13:46:38,412 INFO sqlalchemy.engine.Engine ROLLBACK
CRITICAL: ChromaDB query failed: Error executing plan: Internal error: Error finding id
INFO:     5.28.168.163:0 - "POST /api/chat HTTP/1.1" 200 OK
CRITICAL: ChromaDB query failed: Error executing plan: Internal error: Error finding id
INFO:     5.28.168.163:0 - "POST /api/chat HTTP/1.1" 200 OK
CRITICAL: ChromaDB query failed: Error executing plan: Internal error: Error finding id
INFO:     5.28.168.163:0 - "POST /api/chat HTTP/1.1" 200 OK
2025-12-22 13:56:12,403 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 13:56:12,403 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 13:56:12,403 INFO sqlalchemy.engine.Engine [cached since 675.8s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 13:56:12,407 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     5.28.168.163:0 - "POST /api/chat HTTP/1.1" 200 OK
2025-12-22 14:08:38,138 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 14:08:38,139 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 14:08:38,139 INFO sqlalchemy.engine.Engine [cached since 1422s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 14:08:38,149 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     5.28.168.163:0 - "POST /api/chat HTTP/1.1" 200 OK
2025-12-22 14:09:30,495 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-12-22 14:09:30,495 INFO sqlalchemy.engine.Engine SELECT brand.id, brand.name, brand.logo_url, brand.website_url, brand.description, brand.primary_color, brand.secondary_color 
FROM brand
 LIMIT ? OFFSET ?
2025-12-22 14:09:30,495 INFO sqlalchemy.engine.Engine [cached since 1474s ago] (100, 0)
INFO:     5.28.168.163:0 - "GET /api/brands HTTP/1.1" 200 OK
2025-12-22 14:09:30,498 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:     5.28.168.163:0 - "POST /api/chat HTTP/1.1" 200 OK
